<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <!-- PWA Configuration -->
    <link rel="manifest" href="./manifest.json">
    <!-- Theme color meta removed for Firefox/Opera compatibility -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-status-bar-style" content="default">
    <meta name="mobile-web-app-title" content="JoshBurt.com.au">
    <link rel="apple-touch-icon" href="./assets/images/logo-placeholder.svg">
    
    <link rel="stylesheet" href="./assets/css/styles.css">

        <!-- Load shared config and theme system -->
        <script>
            fetch('shared-config.html').then(r => r.text()).then(html => {
                const temp = document.createElement('div');
                temp.innerHTML = html;
                Array.from(temp.children).forEach(child => {
                    if (child.tagName === 'LINK' || child.tagName === 'STYLE' || child.tagName === 'SCRIPT') {
                        document.head.appendChild(child.cloneNode(true));
                    }
                });
            });
            fetch('shared-theme.html').then(r => r.text()).then(html => {
                const temp = document.createElement('div');
                temp.innerHTML = html;
                Array.from(temp.children).forEach(child => {
                    if (child.tagName === 'SCRIPT') {
                        document.head.appendChild(child.cloneNode(true));
                    }
                });
            });
        </script>
    <script>
        // Configuration for dynamic color updates from settings
        function applyDynamicColors() {
            const settingsHead = JSON.parse(localStorage.getItem('siteSettings')) || {};
            // Apply CSS variables for instant color update
            document.documentElement.style.setProperty('--tw-color-primary', settingsHead.primaryColor || '#3b82f6');
            document.documentElement.style.setProperty('--tw-color-secondary', settingsHead.secondaryColor || '#10b981');
            document.documentElement.style.setProperty('--tw-color-accent', settingsHead.accentColor || '#8b5cf6');
        }
        applyDynamicColors();
        // Service Worker Registration for PWA
        if ("serviceWorker" in navigator) {
            window.addEventListener("load", () => {
                navigator.serviceWorker.register("./sw.js")
                    .then(registration => {
                        console.log("SW registered: ", registration);
                    })
                    .catch(registrationError => {
                        console.log("SW registration failed: ", registrationError);
                    });
            });
        }
    </script>
    <style>
        body {
            transition: background-color 0.3s, color 0.3s;
        }
        .dark {
            background-color: #1f2937;
            color: #f9fafb;
        }
        .light {
            background-color: #f9fafb;
            color: #1f2937;
        }
        .sidebar {
            transition: transform 0.3s ease-in-out;
        }
    </style>
</head>
<body class="dark">
    <!-- Mobile Menu Toggle -->
    <button id="menu-toggle" class="md:hidden fixed top-4 left-4 z-50 p-2 bg-primary text-white rounded-md focus:outline-none focus:ring-2 focus:ring-secondary" aria-label="Toggle sidebar" aria-expanded="false">â˜°</button>
    <div id="sidebar-backdrop" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden"></div>
    <div class="flex flex-col md:flex-row min-h-screen">
        <!-- Sidebar -->
        <!-- Shared Navigation Placeholder -->
        <div id="main-nav"></div>
        <!-- Load shared navigation dynamically -->
        <script>
            fetch('shared-nav.html')
                .then(r => r.text())
                .then(html => {
                    document.getElementById('main-nav').innerHTML = html;
                });
        </script>
        <!-- Main Content -->
    <!-- Main Content -->
    <main id="main-content" class="flex-1 p-4" role="main">
        <!-- Sticky Header -->
    <header class="sticky top-0 p-6 rounded-lg shadow-md mb-6 z-40 border card">
            <h2 class="text-3xl font-bold text-white" id="welcome-message">Welcome, Admin!</h2>
            <p class="text-lg mt-2 nav-link-muted">Administrative Dashboard & Controls</p>
        </header>

        <!-- Content Section -->
        <section aria-label="Administrative functions" class="space-y-6">
            <p class="mb-6 leading-relaxed nav-link-muted">This is your dashboard. Here you can manage users, view site analytics, and perform administrative tasks.</p>
            
            <!-- Admin Cards Grid -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6" role="region" aria-label="Admin functions">
                <div class="card widget-primary p-6 rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2" tabindex="0" role="article">
                    <h3 class="text-xl font-semibold mb-3 text-white">User Management</h3>
                    <p class="mb-4 nav-link-muted">Manage user accounts and permissions.</p>
                    <a href="users.html" class="w-full block p-3 text-black rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 text-center transition-colors duration-200 btn-neon-blue">Manage Users</a>
                </div>
                <div class="card widget-secondary p-6 rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2" tabindex="0" role="article">
                    <h3 class="text-xl font-semibold mb-3 text-white">Analytics</h3>
                    <p class="mb-4 nav-link-muted">View site statistics and user engagement.</p>
                    <a href="analytics.html" class="w-full block p-3 text-black rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 text-center transition-colors duration-200 btn-neon-green">View Analytics</a>
                </div>
                <div class="card widget-accent p-6 rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2" tabindex="0" role="article">
                    <h3 class="text-xl font-semibold mb-3 text-white">Site Settings</h3>
                    <p class="mb-4 nav-link-muted">Configure website settings and preferences.</p>
                    <a href="settings.html" class="w-full block p-3 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 text-center transition-colors duration-200 btn-neon-purple">Site Settings</a>
                </div>
            </div>

            <!-- Additional Management Cards Row -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-8" role="region" aria-label="Product and Order Management">
                <div class="card widget-primary p-6 rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2" tabindex="0" role="article">
                    <h3 class="text-xl font-semibold mb-3 text-white">Oil Product Management</h3>
                    <p class="mb-4 nav-link-muted">Add, edit, and manage oil product inventory and details.</p>
                    <a href="oil-products-mgmt.html" class="w-full block p-3 text-black rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 text-center transition-colors duration-200 btn-neon-blue">Oil Products</a>
                </div>
                <div class="card widget-secondary p-6 rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2" tabindex="0" role="article">
                    <h3 class="text-xl font-semibold mb-3 text-white">Consumables Management</h3>
                    <p class="mb-4 nav-link-muted">Manage consumables inventory, categories, and stock levels.</p>
                    <a href="consumables-mgmt.html" class="w-full block p-3 text-black rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 text-center transition-colors duration-200 btn-neon-green">Consumables Management</a>
                </div>
                <div class="card widget-accent p-6 rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2" tabindex="0" role="article">
                    <h3 class="text-xl font-semibold mb-3 text-white">Order Review</h3>
                    <p class="mb-4 nav-link-muted">Review, approve, and track oil and consumables orders.</p>
                    <a href="orders-review.html" class="w-full block p-3 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 text-center transition-colors duration-200 btn-neon-purple">Review Orders</a>
                </div>
            </div>
        </section>
    </main>

    <!-- Load shared theme functionality -->
    <script>
        fetch('shared-theme.html')
            .then(response => response.text())
            .then(html => {
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = html;
                const scripts = tempDiv.getElementsByTagName('script');
                for (let script of scripts) {
                    const newScript = document.createElement('script');
                    newScript.textContent = script.textContent;
                    document.body.appendChild(newScript);
                }
            });
    </script>
    </div>
                    <script>
                        // Load and apply site settings
                        function loadAndApplySettings() {
                            const settings = JSON.parse(localStorage.getItem('siteSettings')) || {};
                            // Apply site title if set
                            if (settings['site-title']) {
                                const brandingElements = document.querySelectorAll('h1');
                                brandingElements.forEach(el => el.textContent = settings['site-title']);
                            }
                        }
                        loadAndApplySettings();

                        // Sidebar toggle for mobile
                        const menuToggle = document.getElementById('menu-toggle');
                        const sidebar = document.getElementById('sidebar');
                        const sidebarBackdrop = document.getElementById('sidebar-backdrop');
                        menuToggle.addEventListener('click', function() {
                            sidebar.classList.toggle('open');
                            sidebarBackdrop.classList.toggle('open');
                            this.setAttribute('aria-expanded', sidebar.classList.contains('open'));
                        });
                        sidebarBackdrop.addEventListener('click', function() {
                            sidebar.classList.remove('open');
                            sidebarBackdrop.classList.remove('open');
                            menuToggle.setAttribute('aria-expanded', 'false');
                        });
                        // Toast notification helper
                        function showToast(message) {
                            const toast = document.getElementById('toast');
                            toast.textContent = message;
                            toast.classList.remove('hidden');
                            setTimeout(() => toast.classList.add('hidden'), 3000);
                        }
                    </script>
</body>
</html>