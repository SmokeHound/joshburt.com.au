<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oil Products Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#10b981',
                        accent: '#8b5cf6',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', '-apple-system', 'sans-serif'],
                    },
                },
            },
        };
    </script>
    <style>
        body {
            transition: background-color 0.3s, color 0.3s;
        }
        .dark {
            background-color: #1f2937;
            color: #f9fafb;
        }
        .light {
            background-color: #f9fafb;
            color: #1f2937;
        }
        .sidebar {
            transition: transform 0.3s ease-in-out;
        }
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            .sidebar.open {
                transform: translateX(0);
            }
        }
        .card {
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="dark min-h-screen flex font-sans">
    <!-- Mobile Menu Toggle -->
    <button id="menu-toggle" class="md:hidden fixed top-4 left-4 z-50 p-2 bg-primary text-white rounded-md focus:outline-none focus:ring-2 focus:ring-secondary" aria-label="Toggle sidebar" aria-expanded="false">
        â˜°
    </button>

    <!-- Toast Notification -->
    <div id="toast" class="hidden fixed bottom-4 right-4 p-4 bg-accent text-white rounded shadow-lg transition-opacity duration-300" role="alert" aria-live="polite"></div>

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar w-64 bg-gray-800 text-white p-4 fixed md:static h-full overflow-y-auto z-40">
        <!-- Logo/Brand -->
        <div class="mb-8">
            <h1 class="text-2xl font-bold">Admin Panel</h1>
        </div>

        <!-- Navigation -->
        <nav class="space-y-2" role="navigation" aria-label="Main navigation">
            <ul class="space-y-1">
                <li><a href="index.html" class="block p-2 hover:bg-primary hover:text-white rounded focus:outline-none focus:ring-2 focus:ring-secondary">Home</a></li>
                <li><a href="admin.html" class="block p-2 hover:bg-primary hover:text-white rounded focus:outline-none focus:ring-2 focus:ring-secondary">Admin</a></li>
                <li><a href="users.html" class="block p-2 hover:bg-primary hover:text-white rounded focus:outline-none focus:ring-2 focus:ring-secondary">User Management</a></li>
                <li><a href="analytics.html" class="block p-2 hover:bg-primary hover:text-white rounded focus:outline-none focus:ring-2 focus:ring-secondary">Analytics</a></li>
                <li><a href="settings.html" class="block p-2 hover:bg-primary hover:text-white rounded focus:outline-none focus:ring-2 focus:ring-secondary">Settings</a></li>
                <li><a href="oil.html" class="block p-2 hover:bg-primary hover:text-white rounded focus:outline-none focus:ring-2 focus:ring-secondary">Oil Orders</a></li>
                <li><a href="oil-products-management.html" class="block p-2 bg-primary text-white rounded focus:outline-none focus:ring-2 focus:ring-secondary">Product Management</a></li>
                <li><a href="login.html" class="block p-2 hover:bg-red-500 hover:text-white rounded focus:outline-none focus:ring-2 focus:ring-red-400">Logout</a></li>
            </ul>
        </nav>

        <!-- Theme Toggle -->
        <div class="mt-auto">
            <button id="theme-toggle" class="w-full p-2 bg-primary text-white rounded hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-secondary" aria-label="Toggle light mode">
                Toggle Light Mode
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-4 md:ml-0">
        <!-- Sticky Header -->
        <header class="sticky top-0 bg-gray-700 dark:bg-gray-700 p-4 rounded shadow mb-6 z-10">
            <h2 class="text-3xl font-semibold">Oil Products Management</h2>
        </header>

        <!-- Content Section -->
        <section>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Products List -->
                <div class="bg-gray-800 p-6 rounded shadow">
                    <h3 class="text-xl font-semibold mb-4">Products List</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left">
                            <thead class="text-xs uppercase bg-gray-700">
                                <tr>
                                    <th class="py-3 px-3">Code</th>
                                    <th class="py-3 px-3">Name</th>
                                    <th class="py-3 px-3">Type</th>
                                    <th class="py-3 px-3">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="products-table">
                                <!-- Products will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Add/Edit Product Form -->
                <div class="bg-gray-800 p-6 rounded shadow">
                    <h3 class="text-xl font-semibold mb-4" id="form-title">Add New Product</h3>
                    <form id="product-form">
                        <div class="mb-4">
                            <label for="product-code" class="block mb-2 font-medium">Product Code</label>
                            <input type="text" id="product-code" name="product-code" required class="w-full p-2 rounded bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-primary" placeholder="Enter product code">
                        </div>
                        
                        <div class="mb-4">
                            <label for="product-name" class="block mb-2 font-medium">Product Name</label>
                            <input type="text" id="product-name" name="product-name" required class="w-full p-2 rounded bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-primary" placeholder="Enter product name">
                        </div>
                        
                        <div class="mb-4">
                            <label for="product-type" class="block mb-2 font-medium">Type</label>
                            <select id="product-type" name="product-type" required class="w-full p-2 rounded bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-primary">
                                <option value="">Select type</option>
                                <option value="Engine oil">Engine oil</option>
                                <option value="Coolant">Coolant</option>
                                <option value="Brake fluid">Brake fluid</option>
                                <option value="Transmission fluid">Transmission fluid</option>
                            </select>
                        </div>
                        
                        <div class="mb-4">
                            <label for="product-specs" class="block mb-2 font-medium">Specifications</label>
                            <textarea id="product-specs" name="product-specs" required class="w-full p-2 rounded bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-primary" rows="3" placeholder="Enter product specifications"></textarea>
                        </div>
                        
                        <div class="mb-4">
                            <label for="product-description" class="block mb-2 font-medium">Description</label>
                            <textarea id="product-description" name="product-description" class="w-full p-2 rounded bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-primary" rows="3" placeholder="Enter detailed product description"></textarea>
                        </div>
                        
                        <div class="mb-4">
                            <label for="product-image" class="block mb-2 font-medium">Image URL</label>
                            <input type="url" id="product-image" name="product-image" class="w-full p-2 rounded bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-primary" placeholder="Enter image URL">
                        </div>
                        
                        <div class="flex gap-2">
                            <button type="submit" class="flex-1 p-2 bg-primary text-white rounded hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-secondary">Add Product</button>
                            <button type="button" id="cancel-edit" class="px-4 p-2 bg-gray-600 text-white rounded hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-400 hidden">Cancel</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Bulk Operations -->
            <div class="bg-gray-800 p-6 rounded shadow mt-6">
                <h3 class="text-xl font-semibold mb-4">Bulk Operations</h3>
                <div class="flex flex-wrap gap-4">
                    <button id="export-products" class="px-4 py-2 bg-secondary text-white rounded hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-400">Export Products (CSV)</button>
                    <label for="import-products" class="px-4 py-2 bg-accent text-white rounded hover:bg-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-400 cursor-pointer">
                        Import Products (CSV)
                        <input type="file" id="import-products" accept=".csv" class="hidden">
                    </label>
                </div>
            </div>
        </section>
    </main>

    <script>
        let products = [];
        let editingProductId = null;

        // Initialize default products if none exist
        function initializeProducts() {
            const defaultProducts = [
                { id: 1, code: "3437297", name: "EDGE 0W-20", specs: "API SP, ILSAC GF-6", type: "Engine oil", description: "High-performance synthetic engine oil for modern vehicles", image: "" },
                { id: 2, code: "3425218", name: "EDGE 0W-20 C5", specs: "ACEA C5/C6, API SP, ILSAC GF-6", type: "Engine oil", description: "Advanced formula for fuel economy and engine protection", image: "" },
                { id: 3, code: "3433822", name: "EDGE 0W-20 LL IV", specs: "ACEA C5, C6, BMW Longlife-17FE+", type: "Engine oil", description: "Specialized formula for European vehicles", image: "" },
            ];
            
            const savedProducts = localStorage.getItem('oilProducts');
            if (!savedProducts) {
                products = defaultProducts;
                saveProducts();
            }
        }

        // Load products from localStorage
        function loadProducts() {
            const savedProducts = localStorage.getItem('oilProducts');
            products = savedProducts ? JSON.parse(savedProducts) : [];
            renderProducts();
        }

        // Save products to localStorage
        function saveProducts() {
            localStorage.setItem('oilProducts', JSON.stringify(products));
        }

        // Render products table
        function renderProducts() {
            const tbody = document.getElementById('products-table');
            tbody.innerHTML = '';
            
            products.forEach(product => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-700';
                row.innerHTML = `
                    <td class="py-2 px-3 font-mono text-sm">${product.code}</td>
                    <td class="py-2 px-3">${product.name}</td>
                    <td class="py-2 px-3">${product.type}</td>
                    <td class="py-2 px-3">
                        <button class="edit-product text-primary hover:text-secondary mr-2" data-id="${product.id}">Edit</button>
                        <button class="delete-product text-red-500 hover:text-red-400" data-id="${product.id}">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Add or update product
        function addOrUpdateProduct(e) {
            e.preventDefault();
            
            const form = document.getElementById('product-form');
            const formData = new FormData(form);
            
            const code = formData.get('product-code').trim();
            const name = formData.get('product-name').trim();
            const type = formData.get('product-type');
            const specs = formData.get('product-specs').trim();
            const description = formData.get('product-description').trim();
            const image = formData.get('product-image').trim();
            
            if (!code || !name || !type || !specs) {
                showToast('Please fill in all required fields', 'error');
                return;
            }

            if (editingProductId) {
                // Update existing product
                const productIndex = products.findIndex(p => p.id === editingProductId);
                if (productIndex !== -1) {
                    products[productIndex] = { id: editingProductId, code, name, type, specs, description, image };
                    showToast('Product updated successfully!', 'success');
                    editingProductId = null;
                    form.querySelector('button[type="submit"]').textContent = 'Add Product';
                    document.getElementById('form-title').textContent = 'Add New Product';
                    document.getElementById('cancel-edit').classList.add('hidden');
                }
            } else {
                // Add new product
                const newProduct = {
                    id: Date.now(),
                    code,
                    name,
                    type,
                    specs,
                    description,
                    image
                };
                products.push(newProduct);
                showToast('Product added successfully!', 'success');
            }
            
            form.reset();
            saveProducts();
            renderProducts();
        }

        // Edit product
        function editProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            const form = document.getElementById('product-form');
            document.getElementById('product-code').value = product.code;
            document.getElementById('product-name').value = product.name;
            document.getElementById('product-type').value = product.type;
            document.getElementById('product-specs').value = product.specs;
            document.getElementById('product-description').value = product.description || '';
            document.getElementById('product-image').value = product.image || '';
            
            editingProductId = productId;
            form.querySelector('button[type="submit"]').textContent = 'Update Product';
            document.getElementById('form-title').textContent = 'Edit Product';
            document.getElementById('cancel-edit').classList.remove('hidden');
        }

        // Cancel edit
        function cancelEdit() {
            const form = document.getElementById('product-form');
            form.reset();
            editingProductId = null;
            form.querySelector('button[type="submit"]').textContent = 'Add Product';
            document.getElementById('form-title').textContent = 'Add New Product';
            document.getElementById('cancel-edit').classList.add('hidden');
        }

        // Delete product
        function deleteProduct(productId) {
            if (confirm('Are you sure you want to delete this product?')) {
                products = products.filter(p => p.id !== productId);
                saveProducts();
                renderProducts();
                showToast('Product deleted successfully!', 'success');
            }
        }

        // Export products to CSV
        function exportProducts() {
            const headers = ['Code', 'Name', 'Type', 'Specs', 'Description', 'Image URL'];
            const csvContent = [
                headers.join(','),
                ...products.map(product => [
                    `"${product.code}"`,
                    `"${product.name}"`,
                    `"${product.type}"`,
                    `"${product.specs}"`,
                    `"${product.description || ''}"`,
                    `"${product.image || ''}"`
                ].join(','))
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'oil_products.csv';
            a.click();
            URL.revokeObjectURL(url);
            showToast('Products exported successfully!', 'success');
        }

        // Import products from CSV
        function importProducts(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const csv = e.target.result;
                    const lines = csv.split('\n');
                    const importedProducts = [];

                    // Skip header row
                    for (let i = 1; i < lines.length; i++) {
                        const line = lines[i].trim();
                        if (!line) continue;

                        const fields = line.split(',').map(field => field.replace(/^"|"$/g, ''));
                        if (fields.length >= 4) {
                            importedProducts.push({
                                id: Date.now() + i,
                                code: fields[0],
                                name: fields[1],
                                type: fields[2],
                                specs: fields[3],
                                description: fields[4] || '',
                                image: fields[5] || ''
                            });
                        }
                    }

                    if (importedProducts.length > 0) {
                        products.push(...importedProducts);
                        saveProducts();
                        renderProducts();
                        showToast(`${importedProducts.length} products imported successfully!`, 'success');
                    } else {
                        showToast('No valid products found in CSV file', 'error');
                    }
                } catch (error) {
                    showToast('Error importing CSV file', 'error');
                }
            };
            reader.readAsText(file);
            
            // Reset input
            event.target.value = '';
        }

        // Toast notification utility
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `fixed bottom-4 right-4 p-4 text-white rounded shadow-lg transition-opacity duration-300 ${type === 'success' ? 'bg-secondary' : type === 'error' ? 'bg-red-500' : 'bg-accent'}`;
            toast.classList.remove('hidden');
            setTimeout(() => {
                toast.classList.add('hidden');
            }, 3000);
        }

        // Theme toggle functionality
        const themeToggle = document.getElementById('theme-toggle');
        const body = document.body;
        
        themeToggle.addEventListener('click', () => {
            body.classList.toggle('dark');
            body.classList.toggle('light');
            localStorage.setItem('theme', body.classList.contains('dark') ? 'dark' : 'light');
            themeToggle.textContent = body.classList.contains('dark') ? 'Toggle Light Mode' : 'Toggle Dark Mode';
        });

        // Load saved theme
        const savedTheme = localStorage.getItem('theme') || 'dark';
        body.classList.add(savedTheme);
        themeToggle.textContent = savedTheme === 'dark' ? 'Toggle Light Mode' : 'Toggle Dark Mode';

        // Mobile menu toggle
        const menuToggle = document.getElementById('menu-toggle');
        const sidebar = document.getElementById('sidebar');
        
        if (menuToggle && sidebar) {
            menuToggle.addEventListener('click', () => {
                sidebar.classList.toggle('open');
                const isOpen = sidebar.classList.contains('open');
                menuToggle.setAttribute('aria-expanded', isOpen);
            });
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', () => {
            initializeProducts();
            loadProducts();
            
            // Form submission
            document.getElementById('product-form').addEventListener('submit', addOrUpdateProduct);
            
            // Cancel edit button
            document.getElementById('cancel-edit').addEventListener('click', cancelEdit);
            
            // Edit and delete buttons
            document.getElementById('products-table').addEventListener('click', (e) => {
                if (e.target.classList.contains('edit-product')) {
                    editProduct(parseInt(e.target.dataset.id));
                } else if (e.target.classList.contains('delete-product')) {
                    deleteProduct(parseInt(e.target.dataset.id));
                }
            });

            // Export/Import buttons
            document.getElementById('export-products').addEventListener('click', exportProducts);
            document.getElementById('import-products').addEventListener('change', importProducts);
        });
    </script>
</body>
</html>