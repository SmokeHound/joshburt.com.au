<!-- Shared Theme Toggle Functionality with Accessibility -->
<script>
(function() {
    // Theme Toggle with enhanced accessibility
    function initTheme() {
        const themeToggle = document.getElementById('theme-toggle');
        const body = document.body;
        
        if (!themeToggle) return;
        
        themeToggle.addEventListener('click', () => {
            body.classList.toggle('dark');
            body.classList.toggle('light');
            const isDark = body.classList.contains('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            themeToggle.textContent = isDark ? 'Toggle Light Mode' : 'Toggle Dark Mode';
            themeToggle.setAttribute('aria-label', isDark ? 'Toggle light mode' : 'Toggle dark mode');
            themeToggle.setAttribute('aria-pressed', isDark ? 'false' : 'true');
            
            // Announce theme change to screen readers
            if (window.announceToScreenReader) {
                window.announceToScreenReader(`Switched to ${isDark ? 'dark' : 'light'} theme`);
            }
        });

        // Keyboard support for theme toggle
        themeToggle.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                themeToggle.click();
            }
        });

        // Load saved theme
        const savedTheme = localStorage.getItem('theme') || 'dark';
        body.classList.add(savedTheme);
        const isDark = savedTheme === 'dark';
        themeToggle.textContent = isDark ? 'Toggle Light Mode' : 'Toggle Dark Mode';
        themeToggle.setAttribute('aria-label', isDark ? 'Toggle light mode' : 'Toggle dark mode');
        themeToggle.setAttribute('aria-pressed', isDark ? 'false' : 'true');
    }

    // Screen reader announcement function
    window.announceToScreenReader = function(message) {
        const announcement = document.createElement('div');
        announcement.setAttribute('aria-live', 'polite');
        announcement.setAttribute('aria-atomic', 'true');
        announcement.className = 'sr-only';
        announcement.textContent = message;
        document.body.appendChild(announcement);
        setTimeout(() => {
            if (document.body.contains(announcement)) {
                document.body.removeChild(announcement);
            }
        }, 1000);
    };

    // Initialize theme when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initTheme);
    } else {
        initTheme();
    }
})();
</script>