<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<!-- Shared Tailwind CSS Configuration and Common Styles -->
<link rel="stylesheet" href="./assets/css/styles.css">
<!-- Preload critical resources for performance -->
<link rel="preload" href="./assets/css/styles.css" as="style">
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<!-- Ensure proper viewport meta tag is present -->
<!-- tokens: tailwind primary secondary accent -->
<script>
    // Verify viewport meta tag exists
    if (!document.querySelector('meta[name="viewport"]')) {
        const viewport = document.createElement('meta');
        viewport.name = 'viewport';
        viewport.content = 'width=device-width, initial-scale=1.0, user-scalable=yes';
        document.head.appendChild(viewport);
    }
</script>
<script>
    // Load centralized theme manager
    fetch('shared-theme.html')
        .then(r => r.text())
        .then(html => {
            const temp = document.createElement('div');
            temp.innerHTML = html;
            const scripts = temp.getElementsByTagName('script');
            for (let script of scripts) {
                const newScript = document.createElement('script');
                newScript.textContent = script.textContent;
                document.head.appendChild(newScript);
            }
        })
        .catch(err => console.warn('Failed to load shared-theme.html:', err));
</script>
<!-- Auth0 config placeholders: override these in a secure way (env-injected script or Netlify config inject) -->
<script>
    // You can override these at deploy-time using an injected <script> or Netlify environment replacement
    window.AUTH0_DOMAIN = window.AUTH0_DOMAIN || '';
    window.AUTH0_CLIENT_ID = window.AUTH0_CLIENT_ID || '';
    window.AUTH0_AUDIENCE = window.AUTH0_AUDIENCE || '';
    window.AUTH0_REDIRECT_URI = window.AUTH0_REDIRECT_URI || (window.location.origin + '/oauth-success.html');
    window.AUTH0_SCOPE = window.AUTH0_SCOPE || 'openid profile email';
</script>
<style>
    body {
        transition: background-color 0.3s, color 0.3s;
    }
    .dark {
        background-color: #1f2937;
        color: #f9fafb;
    }
    .light {
        background-color: #f9fafb;
        color: #1f2937;
    }
    
    /* Enhanced card styling with proper dark/light mode support */
    .card {
        transition: transform 0.2s, box-shadow 0.2s, background-color 0.3s;
        min-height: 120px;
    }
    
    .card:hover, .card:focus-within {
        transform: translateY(-4px);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
    }
    
    .dark .card:hover, .dark .card:focus-within {
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
    }
    
    /* Widget background variations for better separation */
    .widget-primary {
        background-color: #e0f2fe;
    }
    .dark .widget-primary {
        background-color: #0042ff1a;
    }
    
    .widget-secondary {
        background-color: #dcfce7;
    }
    .dark .widget-secondary {
        background-color: #00ff621a;
    }
    
    .widget-accent {
        background-color: #f3e8ff;
    }
    .dark .widget-accent {
        background-color: #591c871a;
    }
    
    /* Enhanced focus states for accessibility */
    .focus-visible, [tabindex]:focus-visible, button:focus-visible, a:focus-visible, input:focus-visible, select:focus-visible, textarea:focus-visible {
        outline: 2px solid #3b82f6;
        outline-offset: 2px;
        box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
    }
    
    .dark .focus-visible, .dark [tabindex]:focus-visible, .dark button:focus-visible, .dark a:focus-visible, .dark input:focus-visible, .dark select:focus-visible, .dark textarea:focus-visible {
        outline-color: #60a5fa;
        box-shadow: 0 0 0 4px rgba(96, 165, 250, 0.2);
    }
    
    /* Toast notifications styling moved to shared-notifications.html */
    
    /* Modal overlay */
    .modal-overlay {
        z-index: 9990;
    }
    
    /* Loading states */
    .loading-skeleton {
        background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
    }
    
    .dark .loading-skeleton {
        background: linear-gradient(90deg, #374151 25%, #4b5563 50%, #374151 75%);
        background-size: 200% 100%;
    }
    
    @keyframes loading {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
    }
    
    /* Sidebar styles - Unified for all pages */
    .sidebar {
        background-color: #374151; /* Gray-700 equivalent */
        transition: transform 0.3s ease-in-out;
    }
    
    /* Mobile sidebar styles - Unified for all pages */
    @media (max-width: 768px) {
        .sidebar {
            transform: translateX(-100%);
            z-index: 40;
        }
        .sidebar.open {
            transform: translateX(0);
        }
        .sidebar-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 30;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
        }
        .sidebar-backdrop.show {
            opacity: 1;
            pointer-events: auto;
        }
        body.sidebar-open {
            overflow: hidden;
        }
        
        /* Enhanced touch targets for mobile */
        button, input, select, textarea {
            min-height: 44px;
        }
        
        /* Mobile-specific content adjustments */
        main {
            margin-left: 0;
        }
        
        /* Oil ordering system mobile adjustments */
        .lg\:col-span-2 {
            grid-column: span 1;
        }
        .lg\:col-span-1 {
            grid-column: span 1;
        }
    }
    
    /* Tablet optimizations - Enhanced for better tablet experience */
    @media (min-width: 768px) and (max-width: 1023px) {
        .sidebar {
            width: 200px;
        }
        main {
            margin-left: 200px;
        }
        
        /* Tablet grid density improvements */
        .grid-cols-1.sm\:grid-cols-2.lg\:grid-cols-3 {
            grid-template-columns: repeat(2, minmax(0, 1fr));
        }
        
        /* Better card spacing for tablets */
        .card {
            min-height: 120px;
        }
    }
    
    /* Large mobile/small tablet specific */
    @media (min-width: 480px) and (max-width: 767px) {
        .grid-cols-1 {
            grid-template-columns: repeat(2, minmax(0, 1fr));
        }
    }
    
    /* Wide desktop optimizations */
    @media (min-width: 1200px) {
        .sidebar {
            width: 280px;
        }
        main {
            margin-left: 280px;
        }
        
        /* Better use of screen real estate */
        .lg\:grid-cols-3 {
            grid-template-columns: repeat(4, minmax(0, 1fr));
        }
    }
    
    .card {
        transition: transform 0.2s, box-shadow 0.2s;
    }
    .card:hover {
        transform: translateY(-4px);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    /* Responsive image handling */
    img {
        max-width: 100%;
        height: auto;
    }
    
    /* Progressive image loading */
    img[data-src] {
        opacity: 0;
        transition: opacity 0.3s;
    }
    
    img[data-src].loaded {
        opacity: 1;
    }
    
    /* Reduced motion support */
    @media (prefers-reduced-motion: reduce) {
        *, *::before, *::after {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
        }
        
        .card {
            transition: none;
        }
        
        .card:hover {
            transform: none;
        }
    }

    /* Reusable page header utility to standardize top header cards */
    .page-header {
        position: sticky;
        top: 0;
        z-index: 40; /* sits above sidebar backdrop */
        padding: 1.5rem; /* p-6 */
        border-radius: 0.5rem; /* rounded-lg */
        margin-bottom: 1.5rem; /* mb-6 */
        border: 1px solid #e5e7eb; /* light: gray-200 */
        box-shadow: 0 4px 6px rgba(0,0,0,0.10); /* shadow-md */
        background-color: rgba(255,255,255,0.85);
        -webkit-backdrop-filter: saturate(180%) blur(8px);
        backdrop-filter: saturate(180%) blur(8px);
    }
    .dark .page-header {
        border-color: #374151; /* dark: gray-700 */
        box-shadow: 0 4px 12px rgba(0,0,0,0.30);
        background-color: rgba(17,24,39,0.85); /* near gray-900 */
    }
    
    /* Subtitle and muted text utilities for consistent secondary text */
    .subtitle, .text-subtitle {
        font-size: 0.875rem; /* text-sm */
        line-height: 1.5;
        color: #6b7280; /* gray-500 */
        margin-top: 0.25rem;
    }
    .dark .subtitle, .dark .text-subtitle {
        color: #9ca3af; /* gray-400 */
    }
    
    .muted, .text-muted {
        color: #9ca3af; /* gray-400 */
        font-size: 0.875rem; /* text-sm */
    }
    .dark .muted, .dark .text-muted {
        color: #6b7280; /* gray-500 */
    }
    
    /* Description text for under headers */
    .description, .text-description {
        color: #6b7280; /* gray-500 */
        line-height: 1.625; /* leading-relaxed */
        margin-top: 0.5rem;
        margin-bottom: 1rem;
    }
    .dark .description, .dark .text-description {
        color: #9ca3af; /* gray-400 */
    }

    /* Theme swatch utilities (used by settings UI) */
    .sw-3b82f6 { background-color: #3b82f6; }
    .sw-10b981 { background-color: #10b981; }
    .sw-8b5cf6 { background-color: #8b5cf6; }
    .sw-00d4ff { background-color: #00d4ff; box-shadow: 0 0 10px #00d4ff; }
    .sw-00ff88 { background-color: #00ff88; box-shadow: 0 0 10px #00ff88; }
    .sw-ff00aa { background-color: #ff00aa; box-shadow: 0 0 10px #ff00aa; }
    .sw-00ffff { background-color: #00ffff; }
    .sw-00ff00 { background-color: #00ff00; }
    .sw-ff00ff { background-color: #ff00ff; }
    .sw-0284c7 { background-color: #0284c7; }
    .sw-06b6d4 { background-color: #06b6d4; }
    .sw-0ea5e9 { background-color: #0ea5e9; }
    .sw-166534 { background-color: #166534; }
    .sw-22c55e { background-color: #22c55e; }
    .sw-84cc16 { background-color: #84cc16; }
    .sw-f59e42 { background-color: #f59e42; }
    .sw-ef4444 { background-color: #ef4444; }
    .sw-f472b6 { background-color: #f472b6; }
    .sw-22223b { background-color: #22223b; }
    .sw-4a4e69 { background-color: #4a4e69; }
    .sw-9a8c98 { background-color: #9a8c98; }
    /* Preview variables for the settings preview boxes */
    :root {
        --preview-primary: #3b82f6;
        --preview-secondary: #10b981;
        --preview-accent: #8b5cf6;
    }
    .preview-box-primary { background-color: var(--preview-primary); }
    .preview-box-secondary { background-color: var(--preview-secondary); }
    .preview-box-accent { background-color: var(--preview-accent); }
    /* Preview box visual polish */
    .preview-box-primary, .preview-box-secondary, .preview-box-accent {
        transition: background-color 240ms ease, box-shadow 240ms ease;
    }
    .preview-box-primary:focus, .preview-box-secondary:focus, .preview-box-accent:focus {
        outline: 2px solid rgba(59,130,246,0.6);
        outline-offset: 2px;
    }
    @keyframes preview-pulse {
        0% { box-shadow: 0 0 0 0 rgba(59,130,246,0.0); }
        50% { box-shadow: 0 0 10px 4px rgba(59,130,246,0.08); }
        100% { box-shadow: 0 0 0 0 rgba(59,130,246,0.0); }
    }
    .preview-pulse {
        animation: preview-pulse 800ms ease-in-out;
    }

        /* Shared column width helpers */
        .col-image { width: 72px; }
        .col-actions { width: 120px; }

        /* Modal utilities (shared) */
        .modal-backdrop {
            position: fixed;
            inset: 0;
            z-index: 50;
            /* do not set display here to avoid overriding the hidden utility */
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.7);
        }
        /* Ensure hidden takes precedence when applied */
        .modal-backdrop.hidden { display: none !important; }
        .modal-panel {
            width: 100%;
            max-width: 42rem; /* ~max-w-2xl */
            background-color: #111827; /* gray-900 */
            color: #fff;
            border-radius: 0.5rem;
            padding: 1.5rem;
            border: 2px solid var(--tw-color-accent, #a855f7);
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
        }

        /* Responsive stacked table pattern */
        @media (max-width: 768px) {
            table.responsive-table thead { display: none; }
            table.responsive-table,
            table.responsive-table tbody,
            table.responsive-table tr,
            table.responsive-table td { display: block; width: 100%; }
            table.responsive-table tr { margin-bottom: 0.75rem; }
            table.responsive-table td { display: flex; align-items: center; justify-content: space-between; }
            table.responsive-table td::before {
                content: attr(data-label);
                font-weight: 600;
                color: #9ca3af; /* gray-400 */
                margin-right: 1rem;
            }
        }
</style>
<script>
    // Global handler: show a sign-in CTA when authentication is required.
    (function(){
        try {
            window.addEventListener('auth:required', (ev) => {
                        try {
                            // If a page implements a showSignInCTA function, call it
                            if (typeof window.showSignInCTA === 'function') {
                                try { window.showSignInCTA(ev && ev.detail ? ev.detail : {}); } catch(_){}
                                return true; // event handled
                            }
                            // Otherwise, show shared modal fallback (insert modal once)
                            try {
                                if (!document.getElementById('global-auth-modal')) {
                                    const modal = document.createElement('div');
                                    modal.id = 'global-auth-modal';
                                    modal.className = 'hidden fixed inset-0 z-50 flex items-center justify-center';
                                    modal.innerHTML = `
                                        <div class="absolute inset-0 bg-black bg-opacity-50" id="global-auth-backdrop"></div>
                                        <div class="bg-gray-900 text-white rounded-lg p-6 z-60 max-w-md w-full">
                                            <h3 class="text-lg font-semibold mb-2">Sign in required</h3>
                                            <p class="mb-4">You need to sign in to continue using this page.</p>
                                            <div class="flex gap-2 justify-end">
                                                <button id="global-auth-cancel" class="btn-neon-green px-4 py-2 rounded">Cancel</button>
                                                <button id="global-auth-signin" class="btn-neon-blue px-4 py-2 rounded">Sign in</button>
                                            </div>
                                        </div>`;
                                    document.body.appendChild(modal);
                                    // Wire modal buttons
                                    document.getElementById('global-auth-signin').addEventListener('click', () => {
                                        const ru = encodeURIComponent((ev && ev.detail && ev.detail.returnUrl) ? ev.detail.returnUrl : (window.location.pathname + window.location.search));
                                        window.location.href = `login.html?message=login-required&returnUrl=${ru}`;
                                    });
                                    document.getElementById('global-auth-cancel').addEventListener('click', () => {
                                        try { document.getElementById('global-auth-modal').classList.add('hidden'); } catch(_){}
                                    });
                                }
                                // Show it
                                try { document.getElementById('global-auth-modal').classList.remove('hidden'); } catch(_){}
                            } catch (e) { /* noop */ }
                            return true;
                        } catch (e) { return false; }
                    });
                } catch (e) { /* noop if events unsupported */ }
    })();
</script>
</head>
</html>