<!DOCTYPE html>
<!-- Shared Tailwind CSS Configuration and Common Styles -->
<link rel="stylesheet" href="./assets/css/styles.css">
<!-- Ensure proper viewport meta tag is present -->
<!-- tokens: tailwind primary secondary accent -->
<script>
    // Verify viewport meta tag exists
    if (!document.querySelector('meta[name="viewport"]')) {
        const viewport = document.createElement('meta');
        viewport.name = 'viewport';
        viewport.content = 'width=device-width, initial-scale=1.0, user-scalable=yes';
        document.head.appendChild(viewport);
    }
</script>
<script>
    // Load centralized theme manager
    fetch('shared-theme.html')
        .then(r => r.text())
        .then(html => {
            const temp = document.createElement('div');
            temp.innerHTML = html;
            const scripts = temp.getElementsByTagName('script');
            for (let script of scripts) {
                const newScript = document.createElement('script');
                newScript.textContent = script.textContent;
                document.head.appendChild(newScript);
            }
        })
        .catch(err => console.warn('Failed to load shared-theme.html:', err));
</script>
<!-- Auth0 config placeholders: override these in a secure way (env-injected script or Netlify config inject) -->
<script>
    // You can override these at deploy-time using an injected <script> or Netlify environment replacement
    window.AUTH0_DOMAIN = window.AUTH0_DOMAIN || '';
    window.AUTH0_CLIENT_ID = window.AUTH0_CLIENT_ID || '';
    window.AUTH0_AUDIENCE = window.AUTH0_AUDIENCE || '';
    window.AUTH0_REDIRECT_URI = window.AUTH0_REDIRECT_URI || (window.location.origin + '/oauth-success.html');
    window.AUTH0_SCOPE = window.AUTH0_SCOPE || 'openid profile email';
</script>
<style>
    body {
        transition: background-color 0.3s, color 0.3s;
    }
    .dark {
        background-color: #1f2937;
        color: #f9fafb;
    }
    .light {
        background-color: #f9fafb;
        color: #1f2937;
    }
    
    /* Enhanced card styling with proper dark/light mode support */
    .card {
        transition: transform 0.2s, box-shadow 0.2s, background-color 0.3s;
        min-height: 120px;
    }
    
    .card:hover, .card:focus-within {
        transform: translateY(-4px);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
    }
    
    .dark .card:hover, .dark .card:focus-within {
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
    }
    
    /* Widget background variations for better separation */
    .widget-primary {
        background-color: #e0f2fe;
    }
    .dark .widget-primary {
        background-color: #0042ff4f;
    }
    
    .widget-secondary {
        background-color: #dcfce7;
    }
    .dark .widget-secondary {
        background-color: #00ff622d;
    }
    
    .widget-accent {
        background-color: #f3e8ff;
    }
    .dark .widget-accent {
        background-color: #591c879c;
    }
    
    /* Enhanced focus states for accessibility */
    .focus-visible, [tabindex]:focus-visible, button:focus-visible, a:focus-visible, input:focus-visible, select:focus-visible, textarea:focus-visible {
        outline: 2px solid #3b82f6;
        outline-offset: 2px;
        box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
    }
    
    .dark .focus-visible, .dark [tabindex]:focus-visible, .dark button:focus-visible, .dark a:focus-visible, .dark input:focus-visible, .dark select:focus-visible, .dark textarea:focus-visible {
        outline-color: #60a5fa;
        box-shadow: 0 0 0 4px rgba(96, 165, 250, 0.2);
    }
    
    /* Toast notifications with high z-index */
    .toast {
        z-index: 9999;
        position: fixed;
    }
    
    /* Modal overlay */
    .modal-overlay {
        z-index: 9990;
    }
    
    /* Loading states */
    .loading-skeleton {
        background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
    }
    
    .dark .loading-skeleton {
        background: linear-gradient(90deg, #374151 25%, #4b5563 50%, #374151 75%);
        background-size: 200% 100%;
    }
    
    @keyframes loading {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
    }
    
    /* Sidebar styles - Unified for all pages */
    .sidebar {
        background-color: #374151; /* Gray-700 equivalent */
        transition: transform 0.3s ease-in-out;
    }
    
    /* Mobile sidebar styles - Unified for all pages */
    @media (max-width: 768px) {
        .sidebar {
            transform: translateX(-100%);
            z-index: 40;
        }
        .sidebar.open {
            transform: translateX(0);
        }
        .sidebar-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 30;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
        }
        .sidebar-backdrop.show {
            opacity: 1;
            pointer-events: auto;
        }
        body.sidebar-open {
            overflow: hidden;
        }
        
        /* Enhanced touch targets for mobile */
        button, input, select, textarea {
            min-height: 44px;
        }
        
        /* Mobile-specific content adjustments */
        main {
            margin-left: 0;
        }
        
        /* Oil ordering system mobile adjustments */
        .lg\:col-span-2 {
            grid-column: span 1;
        }
        .lg\:col-span-1 {
            grid-column: span 1;
        }
    }
    
    /* Tablet optimizations - Enhanced for better tablet experience */
    @media (min-width: 768px) and (max-width: 1023px) {
        .sidebar {
            width: 200px;
        }
        main {
            margin-left: 200px;
        }
        
        /* Tablet grid density improvements */
        .grid-cols-1.sm\:grid-cols-2.lg\:grid-cols-3 {
            grid-template-columns: repeat(2, minmax(0, 1fr));
        }
        
        /* Better card spacing for tablets */
        .card {
            min-height: 120px;
        }
    }
    
    /* Large mobile/small tablet specific */
    @media (min-width: 480px) and (max-width: 767px) {
        .grid-cols-1 {
            grid-template-columns: repeat(2, minmax(0, 1fr));
        }
    }
    
    /* Wide desktop optimizations */
    @media (min-width: 1200px) {
        .sidebar {
            width: 280px;
        }
        main {
            margin-left: 280px;
        }
        
        /* Better use of screen real estate */
        .lg\:grid-cols-3 {
            grid-template-columns: repeat(4, minmax(0, 1fr));
        }
    }
    
    .card {
        transition: transform 0.2s, box-shadow 0.2s;
    }
    .card:hover {
        transform: translateY(-4px);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    /* Responsive image handling */
    img {
        max-width: 100%;
        height: auto;
    }
    
    /* Progressive image loading */
    img[data-src] {
        opacity: 0;
        transition: opacity 0.3s;
    }
    
    img[data-src].loaded {
        opacity: 1;
    }
    
    /* Reduced motion support */
    @media (prefers-reduced-motion: reduce) {
        *, *::before, *::after {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
        }
        
        .card {
            transition: none;
        }
        
        .card:hover {
            transform: none;
        }
    }

    /* Reusable page header utility to standardize top header cards */
    .page-header {
        position: sticky;
        top: 0;
        z-index: 40; /* sits above sidebar backdrop */
        padding: 1.5rem; /* p-6 */
        border-radius: 0.5rem; /* rounded-lg */
        margin-bottom: 1.5rem; /* mb-6 */
        border: 1px solid #e5e7eb; /* light: gray-200 */
        box-shadow: 0 4px 6px rgba(0,0,0,0.10); /* shadow-md */
    background-color: rgba(255,255,255,0.85);
    -webkit-backdrop-filter: saturate(180%) blur(8px);
    backdrop-filter: saturate(180%) blur(8px);
    }
    .dark .page-header {
        border-color: #374151; /* dark: gray-700 */
        box-shadow: 0 4px 12px rgba(0,0,0,0.30);
        background-color: rgba(17,24,39,0.85); /* near gray-900 */
    }
</style>