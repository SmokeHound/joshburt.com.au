on: push
name: ðŸš€ Deploy website via FTP on push. 
jobs:
  test-and-deploy:
    name: ðŸ§ª Test and Deploy
    runs-on: ubuntu-latest
    steps:
    - name: ðŸšš Get latest code
      uses: actions/checkout@v4
    
    - name: âš™ï¸ Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '22'
        cache: 'npm'
    
    - name: ðŸ“¦ Install dependencies
      run: npm ci
    
    - name: ðŸ” Lint code
      run: npm run lint
      continue-on-error: false
    
    - name: ðŸ—ï¸ Build CSS
      run: npm run build:css
      continue-on-error: false
    
    - name: ðŸ§ª Run tests
      run: npm test
      continue-on-error: false
    
    - name: ðŸ“Š Build summary
      if: always()
      run: |
        echo "### Build Summary ðŸ“Š" >> $GITHUB_STEP_SUMMARY
        echo "- âœ… Dependencies installed" >> $GITHUB_STEP_SUMMARY
        echo "- âœ… Code linted" >> $GITHUB_STEP_SUMMARY
        echo "- âœ… CSS built" >> $GITHUB_STEP_SUMMARY
        echo "- âœ… Tests passed" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "**Ready for deployment!**" >> $GITHUB_STEP_SUMMARY
    
    - name: ðŸ“‚ Deploy to FTP
      if: success()
      uses: SamKirkland/FTP-Deploy-Action@v4.3.5
      with:
        server: ${{ secrets.ftp_server }}
        username: ${{ secrets.ftp_username }}
        password: ${{ secrets.ftp_password }}
        server-dir: ${{ secrets.ftp_remote_directory }}
        dry-run: false
        exclude: |
         **/.git*
         **/.git*/**
         **/node_modules/**
         **/.vs*/**
         **/tests/**
         **/package*.json
         **/.eslintrc.js
         **/.htmlhintrc
         **/.md*
