on: push
name: 🚀 Deploy website via FTP on push. 
jobs:
  test-and-deploy:
    name: 🧪 Test and Deploy
    runs-on: ubuntu-latest
    steps:
    - name: 🚚 Get latest code
      uses: actions/checkout@v4
    
    - name: ⚙️ Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '22'
        cache: 'npm'
    
    - name: 📦 Install dependencies
      run: npm ci
    
    - name: 🔍 Lint code
      run: npm run lint
      continue-on-error: false
    
    - name: 🏗️ Build CSS
      run: npm run build:css
      continue-on-error: false
    
    - name: 🧪 Run tests
      run: npm test
      continue-on-error: false
    
    - name: 📊 Build summary
      if: always()
      run: |
        echo "### Build Summary 📊" >> $GITHUB_STEP_SUMMARY
        echo "- ✅ Dependencies installed" >> $GITHUB_STEP_SUMMARY
        echo "- ✅ Code linted" >> $GITHUB_STEP_SUMMARY
        echo "- ✅ CSS built" >> $GITHUB_STEP_SUMMARY
        echo "- ✅ Tests passed" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "**Ready for deployment!**" >> $GITHUB_STEP_SUMMARY
    
    - name: 📂 Deploy to FTP
      if: success()
      uses: SamKirkland/FTP-Deploy-Action@v4.3.5
      with:
        server: ${{ secrets.ftp_server }}
        username: ${{ secrets.ftp_username }}
        password: ${{ secrets.ftp_password }}
        server-dir: ${{ secrets.ftp_remote_directory }}
        dry-run: false
        exclude: |
         **/.git*
         **/.git*/**
         **/node_modules/**
         **/.vs*/**
         **/tests/**
         **/package*.json
         **/.eslintrc.js
         **/.htmlhintrc
         **/.md*
